{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Alex Myrie/OneDrive/Desktop/Believe/Mytimerce-Website/Eshop-tutorial/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Alex Myrie/OneDrive/Desktop/Believe/Mytimerce-Website/Eshop-tutorial/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Users/Alex Myrie/OneDrive/Desktop/Believe/Mytimerce-Website/Eshop-tutorial/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/Alex Myrie/OneDrive/Desktop/Believe/Mytimerce-Website/Eshop-tutorial/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import Header from\"../components/Layout/Header\";import{useSelector}from\"react-redux\";import socketIO from\"socket.io-client\";import{format}from\"timeago.js\";import{backend_url,server}from\"../server\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{AiOutlineArrowRight,AiOutlineSend}from\"react-icons/ai\";import{TfiGallery}from\"react-icons/tfi\";import styles from\"../styles/styles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ENDPOINT=\"https://socket-ecommerce-tu68.onrender.com/\";var socketId=socketIO(ENDPOINT,{transports:[\"websocket\"]});var UserInbox=function UserInbox(){var _useSelector=useSelector(function(state){return state.user;}),user=_useSelector.user;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),conversations=_useState2[0],setConversations=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),arrivalMessage=_useState4[0],setArrivalMessage=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),currentChat=_useState6[0],setCurrentChat=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),newMessage=_useState10[0],setNewMessage=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),userData=_useState12[0],setUserData=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),onlineUsers=_useState14[0],setOnlineUsers=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),images=_useState16[0],setImages=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),activeStatus=_useState18[0],setActiveStatus=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),open=_useState20[0],setOpen=_useState20[1];var scrollRef=useRef(null);useEffect(function(){socketId.on(\"getMessage\",function(data){setArrivalMessage({sender:data.senderId,text:data.text,createdAt:Date.now()});});},[]);useEffect(function(){arrivalMessage&&(currentChat===null||currentChat===void 0?void 0:currentChat.members.includes(arrivalMessage.sender))&&setMessages(function(prev){return[].concat(_toConsumableArray(prev),[arrivalMessage]);});},[arrivalMessage,currentChat]);useEffect(function(){var getConversation=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var resonse;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"\".concat(server,\"/conversation/get-all-conversation-user/\").concat(user===null||user===void 0?void 0:user._id),{withCredentials:true});case 3:resonse=_context.sent;setConversations(resonse.data.conversations);_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function getConversation(){return _ref.apply(this,arguments);};}();getConversation();},[user,messages]);useEffect(function(){if(user){var sellerId=user===null||user===void 0?void 0:user._id;socketId.emit(\"addUser\",sellerId);socketId.on(\"getUsers\",function(data){setOnlineUsers(data);});}},[user]);var onlineCheck=function onlineCheck(chat){var chatMembers=chat.members.find(function(member){return member!==(user===null||user===void 0?void 0:user._id);});var online=onlineUsers.find(function(user){return user.userId===chatMembers;});return online?true:false;};// get messages\nuseEffect(function(){var getMessage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"\".concat(server,\"/message/get-all-messages/\").concat(currentChat===null||currentChat===void 0?void 0:currentChat._id));case 3:response=_context2.sent;setMessages(response.data.messages);_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 10:case\"end\":return _context2.stop();}},_callee2,null,[[0,7]]);}));return function getMessage(){return _ref2.apply(this,arguments);};}();getMessage();},[currentChat]);// create new message\nvar sendMessageHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e){var message,receiverId;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:e.preventDefault();message={sender:user._id,text:newMessage,conversationId:currentChat._id};receiverId=currentChat.members.find(function(member){return member!==(user===null||user===void 0?void 0:user._id);});socketId.emit(\"sendMessage\",{senderId:user===null||user===void 0?void 0:user._id,receiverId:receiverId,text:newMessage});_context3.prev=4;if(!(newMessage!==\"\")){_context3.next=8;break;}_context3.next=8;return axios.post(\"\".concat(server,\"/message/create-new-message\"),message).then(function(res){setMessages([].concat(_toConsumableArray(messages),[res.data.message]));updateLastMessage();}).catch(function(error){console.log(error);});case 8:_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](4);console.log(_context3.t0);case 13:case\"end\":return _context3.stop();}},_callee3,null,[[4,10]]);}));return function sendMessageHandler(_x){return _ref3.apply(this,arguments);};}();var updateLastMessage=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:socketId.emit(\"updateLastMessage\",{lastMessage:newMessage,lastMessageId:user._id});_context4.next=3;return axios.put(\"\".concat(server,\"/conversation/update-last-message/\").concat(currentChat._id),{lastMessage:newMessage,lastMessageId:user._id}).then(function(res){setNewMessage(\"\");}).catch(function(error){console.log(error);});case 3:case\"end\":return _context4.stop();}},_callee4);}));return function updateLastMessage(){return _ref4.apply(this,arguments);};}();var handleImageUpload=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(e){var file;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:file=e.target.files[0];setImages(file);imageSendingHandler(file);case 3:case\"end\":return _context5.stop();}},_callee5);}));return function handleImageUpload(_x2){return _ref5.apply(this,arguments);};}();var imageSendingHandler=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(e){var formData,receiverId;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:formData=new FormData();formData.append(\"images\",e);formData.append(\"sender\",user._id);formData.append(\"text\",newMessage);formData.append(\"conversationId\",currentChat._id);receiverId=currentChat.members.find(function(member){return member!==user._id;});socketId.emit(\"sendMessage\",{senderId:user._id,receiverId:receiverId,images:e});_context6.prev=7;_context6.next=10;return axios.post(\"\".concat(server,\"/message/create-new-message\"),formData,{headers:{\"Content-Type\":\"multipart/form-data\"}}).then(function(res){setImages();setMessages([].concat(_toConsumableArray(messages),[res.data.message]));updateLastMessageForImage();});case 10:_context6.next=15;break;case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](7);console.log(_context6.t0);case 15:case\"end\":return _context6.stop();}},_callee6,null,[[7,12]]);}));return function imageSendingHandler(_x3){return _ref6.apply(this,arguments);};}();var updateLastMessageForImage=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(){return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.next=2;return axios.put(\"\".concat(server,\"/conversation/update-last-message/\").concat(currentChat._id),{lastMessage:\"Photo\",lastMessageId:user._id});case 2:case\"end\":return _context7.stop();}},_callee7);}));return function updateLastMessageForImage(){return _ref7.apply(this,arguments);};}();useEffect(function(){var _scrollRef$current;(_scrollRef$current=scrollRef.current)===null||_scrollRef$current===void 0?void 0:_scrollRef$current.scrollIntoView({beahaviour:\"smooth\"});},[messages]);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[!open&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-center text-[30px] py-3 font-Poppins\",children:\"All Messages\"}),conversations&&conversations.map(function(item,index){return/*#__PURE__*/_jsx(MessageList,{data:item,index:index,setOpen:setOpen,setCurrentChat:setCurrentChat,me:user===null||user===void 0?void 0:user._id,setUserData:setUserData,userData:userData,online:onlineCheck(item),setActiveStatus:setActiveStatus},index);})]}),open&&/*#__PURE__*/_jsx(SellerInbox,{setOpen:setOpen,newMessage:newMessage,setNewMessage:setNewMessage,sendMessageHandler:sendMessageHandler,messages:messages,sellerId:user._id,userData:userData,activeStatus:activeStatus,scrollRef:scrollRef,handleImageUpload:handleImageUpload})]});};var MessageList=function MessageList(_ref8){var data=_ref8.data,index=_ref8.index,setOpen=_ref8.setOpen,setCurrentChat=_ref8.setCurrentChat,me=_ref8.me,setUserData=_ref8.setUserData,userData=_ref8.userData,online=_ref8.online,setActiveStatus=_ref8.setActiveStatus;var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),active=_useState22[0],setActive=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),user=_useState24[0],setUser=_useState24[1];var navigate=useNavigate();var handleClick=function handleClick(id){navigate(\"/inbox?\".concat(id));setOpen(true);};useEffect(function(){setActiveStatus(online);var userId=data.members.find(function(user){return user!==me;});var getUser=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(){var res;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return axios.get(\"\".concat(server,\"/shop/get-shop-info/\").concat(userId));case 3:res=_context8.sent;setUser(res.data.shop);_context8.next=10;break;case 7:_context8.prev=7;_context8.t0=_context8[\"catch\"](0);console.log(_context8.t0);case 10:case\"end\":return _context8.stop();}},_callee8,null,[[0,7]]);}));return function getUser(){return _ref9.apply(this,arguments);};}();getUser();},[me,data]);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex p-3 px-3 \".concat(active===index?\"bg-[#00000010]\":\"bg-transparent\",\"  cursor-pointer\"),onClick:function onClick(e){return setActive(index)||handleClick(data._id)||setCurrentChat(data)||setUserData(user)||setActiveStatus(online);},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(user===null||user===void 0?void 0:user.avatar),alt:\"\",className:\"w-[50px] h-[50px] rounded-full\"}),online?/*#__PURE__*/_jsx(\"div\",{className:\"w-[12px] h-[12px] bg-green-400 rounded-full absolute top-[2px] right-[2px]\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-[12px] h-[12px] bg-[#c7b9b9] rounded-full absolute top-[2px] right-[2px]\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pl-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px]\",children:user===null||user===void 0?void 0:user.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-[16px] text-[#000c]\",children:[(data===null||data===void 0?void 0:data.lastMessageId)!==(userData===null||userData===void 0?void 0:userData._id)?\"You:\":(userData===null||userData===void 0?void 0:userData.name.split(\" \")[0])+\": \",\" \",data===null||data===void 0?void 0:data.lastMessage]})]})]});};var SellerInbox=function SellerInbox(_ref10){var setOpen=_ref10.setOpen,newMessage=_ref10.newMessage,setNewMessage=_ref10.setNewMessage,sendMessageHandler=_ref10.sendMessageHandler,messages=_ref10.messages,sellerId=_ref10.sellerId,userData=_ref10.userData,activeStatus=_ref10.activeStatus,scrollRef=_ref10.scrollRef,handleImageUpload=_ref10.handleImageUpload;return/*#__PURE__*/_jsxs(\"div\",{className:\"w-[full] min-h-full flex flex-col justify-between p-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex p-3 items-center justify-between bg-slate-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(userData===null||userData===void 0?void 0:userData.avatar),alt:\"\",className:\"w-[60px] h-[60px] rounded-full\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pl-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px] font-[600]\",children:userData===null||userData===void 0?void 0:userData.name}),/*#__PURE__*/_jsx(\"h1\",{children:activeStatus?\"Active Now\":\"\"})]})]}),/*#__PURE__*/_jsx(AiOutlineArrowRight,{size:20,className:\"cursor-pointer\",onClick:function onClick(){return setOpen(false);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-3 h-[75vh] py-3 overflow-y-scroll\",children:messages&&messages.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full my-2 \".concat(item.sender===sellerId?\"justify-end\":\"justify-start\"),ref:scrollRef,children:[item.sender!==sellerId&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(userData===null||userData===void 0?void 0:userData.avatar),className:\"w-[40px] h-[40px] rounded-full mr-3\",alt:\"\"}),item.images&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(item.images),className:\"w-[300px] h-[300px] object-cover rounded-[10px] ml-2 mb-2\"}),item.text!==\"\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-max p-2 rounded \".concat(item.sender===sellerId?\"bg-[#000]\":\"bg-[#38c776]\",\" text-[#fff] h-min\"),children:/*#__PURE__*/_jsx(\"p\",{children:item.text})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[12px] text-[#000000d3] pt-1\",children:format(item.createdAt)})]})]});})}),/*#__PURE__*/_jsxs(\"form\",{\"aria-required\":true,className:\"p-3 relative w-full flex justify-between items-center\",onSubmit:sendMessageHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-[30px]\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"\",id:\"image\",className:\"hidden\",onChange:handleImageUpload}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image\",children:/*#__PURE__*/_jsx(TfiGallery,{className:\"cursor-pointer\",size:20})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,placeholder:\"Enter your message...\",value:newMessage,onChange:function onChange(e){return setNewMessage(e.target.value);},className:\"\".concat(styles.input)}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Send\",className:\"hidden\",id:\"send\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"send\",children:/*#__PURE__*/_jsx(AiOutlineSend,{size:20,className:\"absolute right-4 top-5 cursor-pointer\"})})]})]})]});};export default UserInbox;","map":{"version":3,"names":["React","useEffect","useRef","useState","Header","useSelector","socketIO","format","backend_url","server","axios","useNavigate","AiOutlineArrowRight","AiOutlineSend","TfiGallery","styles","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ENDPOINT","socketId","transports","UserInbox","_useSelector","state","user","_useState","_useState2","_slicedToArray","conversations","setConversations","_useState3","_useState4","arrivalMessage","setArrivalMessage","_useState5","_useState6","currentChat","setCurrentChat","_useState7","_useState8","messages","setMessages","_useState9","_useState10","newMessage","setNewMessage","_useState11","_useState12","userData","setUserData","_useState13","_useState14","onlineUsers","setOnlineUsers","_useState15","_useState16","images","setImages","_useState17","_useState18","activeStatus","setActiveStatus","_useState19","_useState20","open","setOpen","scrollRef","on","data","sender","senderId","text","createdAt","Date","now","members","includes","prev","concat","_toConsumableArray","getConversation","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resonse","wrap","_callee$","_context","next","get","_id","withCredentials","sent","t0","stop","apply","arguments","sellerId","emit","onlineCheck","chat","chatMembers","find","member","online","userId","getMessage","_ref2","_callee2","response","_callee2$","_context2","console","log","sendMessageHandler","_ref3","_callee3","e","message","receiverId","_callee3$","_context3","preventDefault","conversationId","post","then","res","updateLastMessage","catch","error","_x","_ref4","_callee4","_callee4$","_context4","lastMessage","lastMessageId","put","handleImageUpload","_ref5","_callee5","file","_callee5$","_context5","target","files","imageSendingHandler","_x2","_ref6","_callee6","formData","_callee6$","_context6","FormData","append","headers","updateLastMessageForImage","_x3","_ref7","_callee7","_callee7$","_context7","_scrollRef$current","current","scrollIntoView","beahaviour","className","children","map","item","index","MessageList","me","SellerInbox","_ref8","_useState21","_useState22","active","setActive","_useState23","_useState24","setUser","navigate","handleClick","id","getUser","_ref9","_callee8","_callee8$","_context8","shop","onClick","src","avatar","alt","name","split","_ref10","size","ref","onSubmit","type","onChange","htmlFor","required","placeholder","value","input"],"sources":["C:/Users/Alex Myrie/OneDrive/Desktop/Believe/Mytimerce-Website/Eshop-tutorial/frontend/src/pages/UserInbox.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport Header from \"../components/Layout/Header\";\r\nimport { useSelector } from \"react-redux\";\r\nimport socketIO from \"socket.io-client\";\r\nimport { format } from \"timeago.js\";\r\nimport { backend_url, server } from \"../server\";\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { AiOutlineArrowRight, AiOutlineSend } from \"react-icons/ai\";\r\nimport { TfiGallery } from \"react-icons/tfi\";\r\nimport styles from \"../styles/styles\";\r\nconst ENDPOINT = \"https://socket-ecommerce-tu68.onrender.com/\";\r\nconst socketId = socketIO(ENDPOINT, { transports: [\"websocket\"] });\r\n\r\nconst UserInbox = () => {\r\n  const { user } = useSelector((state) => state.user);\r\n  const [conversations, setConversations] = useState([]);\r\n  const [arrivalMessage, setArrivalMessage] = useState(null);\r\n  const [currentChat, setCurrentChat] = useState();\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState(\"\");\r\n  const [userData, setUserData] = useState(null);\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n  const [images, setImages] = useState();\r\n  const [activeStatus, setActiveStatus] = useState(false);\r\n  const [open, setOpen] = useState(false);\r\n  const scrollRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    socketId.on(\"getMessage\", (data) => {\r\n      setArrivalMessage({\r\n        sender: data.senderId,\r\n        text: data.text,\r\n        createdAt: Date.now(),\r\n      });\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    arrivalMessage &&\r\n      currentChat?.members.includes(arrivalMessage.sender) &&\r\n      setMessages((prev) => [...prev, arrivalMessage]);\r\n  }, [arrivalMessage, currentChat]);\r\n\r\n  useEffect(() => {\r\n    const getConversation = async () => {\r\n      try {\r\n        const resonse = await axios.get(\r\n          `${server}/conversation/get-all-conversation-user/${user?._id}`,\r\n          {\r\n            withCredentials: true,\r\n          }\r\n        );\r\n\r\n        setConversations(resonse.data.conversations);\r\n      } catch (error) {\r\n        // console.log(error);\r\n      }\r\n    };\r\n    getConversation();\r\n  }, [user, messages]);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      const sellerId = user?._id;\r\n      socketId.emit(\"addUser\", sellerId);\r\n      socketId.on(\"getUsers\", (data) => {\r\n        setOnlineUsers(data);\r\n      });\r\n    }\r\n  }, [user]);\r\n\r\n  const onlineCheck = (chat) => {\r\n    const chatMembers = chat.members.find((member) => member !== user?._id);\r\n    const online = onlineUsers.find((user) => user.userId === chatMembers);\r\n\r\n    return online ? true : false;\r\n  };\r\n\r\n  // get messages\r\n  useEffect(() => {\r\n    const getMessage = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          `${server}/message/get-all-messages/${currentChat?._id}`\r\n        );\r\n        setMessages(response.data.messages);\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    getMessage();\r\n  }, [currentChat]);\r\n\r\n  // create new message\r\n  const sendMessageHandler = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const message = {\r\n      sender: user._id,\r\n      text: newMessage,\r\n      conversationId: currentChat._id,\r\n    };\r\n    const receiverId = currentChat.members.find(\r\n      (member) => member !== user?._id\r\n    );\r\n\r\n    socketId.emit(\"sendMessage\", {\r\n      senderId: user?._id,\r\n      receiverId,\r\n      text: newMessage,\r\n    });\r\n\r\n    try {\r\n      if (newMessage !== \"\") {\r\n        await axios\r\n          .post(`${server}/message/create-new-message`, message)\r\n          .then((res) => {\r\n            setMessages([...messages, res.data.message]);\r\n            updateLastMessage();\r\n          })\r\n          .catch((error) => {\r\n            console.log(error);\r\n          });\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  const updateLastMessage = async () => {\r\n    socketId.emit(\"updateLastMessage\", {\r\n      lastMessage: newMessage,\r\n      lastMessageId: user._id,\r\n    });\r\n\r\n    await axios\r\n      .put(`${server}/conversation/update-last-message/${currentChat._id}`, {\r\n        lastMessage: newMessage,\r\n        lastMessageId: user._id,\r\n      })\r\n      .then((res) => {\r\n        setNewMessage(\"\");\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  const handleImageUpload = async (e) => {\r\n    const file = e.target.files[0];\r\n    setImages(file);\r\n    imageSendingHandler(file);\r\n  };\r\n\r\n  const imageSendingHandler = async (e) => {\r\n    const formData = new FormData();\r\n\r\n    formData.append(\"images\", e);\r\n    formData.append(\"sender\", user._id);\r\n    formData.append(\"text\", newMessage);\r\n    formData.append(\"conversationId\", currentChat._id);\r\n\r\n    const receiverId = currentChat.members.find(\r\n      (member) => member !== user._id\r\n    );\r\n\r\n    socketId.emit(\"sendMessage\", {\r\n      senderId: user._id,\r\n      receiverId,\r\n      images: e,\r\n    });\r\n\r\n    try {\r\n      await axios\r\n        .post(`${server}/message/create-new-message`, formData, {\r\n          headers: {\r\n            \"Content-Type\": \"multipart/form-data\",\r\n          },\r\n        })\r\n        .then((res) => {\r\n          setImages();\r\n          setMessages([...messages, res.data.message]);\r\n          updateLastMessageForImage();\r\n        });\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  const updateLastMessageForImage = async () => {\r\n    await axios.put(\r\n      `${server}/conversation/update-last-message/${currentChat._id}`,\r\n      {\r\n        lastMessage: \"Photo\",\r\n        lastMessageId: user._id,\r\n      }\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollRef.current?.scrollIntoView({ beahaviour: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      {!open && (\r\n        <>\r\n          <Header />\r\n          <h1 className=\"text-center text-[30px] py-3 font-Poppins\">\r\n            All Messages\r\n          </h1>\r\n          {/* All messages list */}\r\n          {conversations &&\r\n            conversations.map((item, index) => (\r\n              <MessageList\r\n                data={item}\r\n                key={index}\r\n                index={index}\r\n                setOpen={setOpen}\r\n                setCurrentChat={setCurrentChat}\r\n                me={user?._id}\r\n                setUserData={setUserData}\r\n                userData={userData}\r\n                online={onlineCheck(item)}\r\n                setActiveStatus={setActiveStatus}\r\n              />\r\n            ))}\r\n        </>\r\n      )}\r\n\r\n      {open && (\r\n        <SellerInbox\r\n          setOpen={setOpen}\r\n          newMessage={newMessage}\r\n          setNewMessage={setNewMessage}\r\n          sendMessageHandler={sendMessageHandler}\r\n          messages={messages}\r\n          sellerId={user._id}\r\n          userData={userData}\r\n          activeStatus={activeStatus}\r\n          scrollRef={scrollRef}\r\n          handleImageUpload={handleImageUpload}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst MessageList = ({\r\n  data,\r\n  index,\r\n  setOpen,\r\n  setCurrentChat,\r\n  me,\r\n  setUserData,\r\n  userData,\r\n  online,\r\n  setActiveStatus,\r\n}) => {\r\n  const [active, setActive] = useState(0);\r\n  const [user, setUser] = useState([]);\r\n  const navigate = useNavigate();\r\n  const handleClick = (id) => {\r\n    navigate(`/inbox?${id}`);\r\n    setOpen(true);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setActiveStatus(online);\r\n    const userId = data.members.find((user) => user !== me);\r\n    const getUser = async () => {\r\n      try {\r\n        const res = await axios.get(`${server}/shop/get-shop-info/${userId}`);\r\n        setUser(res.data.shop);\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    getUser();\r\n  }, [me, data]);\r\n\r\n  return (\r\n    <div\r\n      className={`w-full flex p-3 px-3 ${\r\n        active === index ? \"bg-[#00000010]\" : \"bg-transparent\"\r\n      }  cursor-pointer`}\r\n      onClick={(e) =>\r\n        setActive(index) ||\r\n        handleClick(data._id) ||\r\n        setCurrentChat(data) ||\r\n        setUserData(user) ||\r\n        setActiveStatus(online)\r\n      }\r\n    >\r\n      <div className=\"relative\">\r\n        <img\r\n          src={`${backend_url}${user?.avatar}`}\r\n          alt=\"\"\r\n          className=\"w-[50px] h-[50px] rounded-full\"\r\n        />\r\n        {online ? (\r\n          <div className=\"w-[12px] h-[12px] bg-green-400 rounded-full absolute top-[2px] right-[2px]\" />\r\n        ) : (\r\n          <div className=\"w-[12px] h-[12px] bg-[#c7b9b9] rounded-full absolute top-[2px] right-[2px]\" />\r\n        )}\r\n      </div>\r\n      <div className=\"pl-3\">\r\n        <h1 className=\"text-[18px]\">{user?.name}</h1>\r\n        <p className=\"text-[16px] text-[#000c]\">\r\n          {data?.lastMessageId !== userData?._id\r\n            ? \"You:\"\r\n            : userData?.name.split(\" \")[0] + \": \"}{\" \"}\r\n          {data?.lastMessage}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst SellerInbox = ({\r\n  setOpen,\r\n  newMessage,\r\n  setNewMessage,\r\n  sendMessageHandler,\r\n  messages,\r\n  sellerId,\r\n  userData,\r\n  activeStatus,\r\n  scrollRef,\r\n  handleImageUpload,\r\n}) => {\r\n  return (\r\n    <div className=\"w-[full] min-h-full flex flex-col justify-between p-5\">\r\n      {/* message header */}\r\n      <div className=\"w-full flex p-3 items-center justify-between bg-slate-200\">\r\n        <div className=\"flex\">\r\n          <img\r\n            src={`${backend_url}${userData?.avatar}`}\r\n            alt=\"\"\r\n            className=\"w-[60px] h-[60px] rounded-full\"\r\n          />\r\n          <div className=\"pl-3\">\r\n            <h1 className=\"text-[18px] font-[600]\">{userData?.name}</h1>\r\n            <h1>{activeStatus ? \"Active Now\" : \"\"}</h1>\r\n          </div>\r\n        </div>\r\n        <AiOutlineArrowRight\r\n          size={20}\r\n          className=\"cursor-pointer\"\r\n          onClick={() => setOpen(false)}\r\n        />\r\n      </div>\r\n\r\n      {/* messages */}\r\n      <div className=\"px-3 h-[75vh] py-3 overflow-y-scroll\">\r\n        {messages &&\r\n          messages.map((item, index) => (\r\n            <div\r\n              className={`flex w-full my-2 ${\r\n                item.sender === sellerId ? \"justify-end\" : \"justify-start\"\r\n              }`}\r\n              ref={scrollRef}\r\n            >\r\n              {item.sender !== sellerId && (\r\n                <img\r\n                  src={`${backend_url}${userData?.avatar}`}\r\n                  className=\"w-[40px] h-[40px] rounded-full mr-3\"\r\n                  alt=\"\"\r\n                />\r\n              )}\r\n              {item.images && (\r\n                <img\r\n                  src={`${backend_url}${item.images}`}\r\n                  className=\"w-[300px] h-[300px] object-cover rounded-[10px] ml-2 mb-2\"\r\n                />\r\n              )}\r\n              {item.text !== \"\" && (\r\n                <div>\r\n                  <div\r\n                    className={`w-max p-2 rounded ${\r\n                      item.sender === sellerId ? \"bg-[#000]\" : \"bg-[#38c776]\"\r\n                    } text-[#fff] h-min`}\r\n                  >\r\n                    <p>{item.text}</p>\r\n                  </div>\r\n\r\n                  <p className=\"text-[12px] text-[#000000d3] pt-1\">\r\n                    {format(item.createdAt)}\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n      </div>\r\n\r\n      {/* send message input */}\r\n      <form\r\n        aria-required={true}\r\n        className=\"p-3 relative w-full flex justify-between items-center\"\r\n        onSubmit={sendMessageHandler}\r\n      >\r\n        <div className=\"w-[30px]\">\r\n          <input\r\n            type=\"file\"\r\n            name=\"\"\r\n            id=\"image\"\r\n            className=\"hidden\"\r\n            onChange={handleImageUpload}\r\n          />\r\n          <label htmlFor=\"image\">\r\n            <TfiGallery className=\"cursor-pointer\" size={20} />\r\n          </label>\r\n        </div>\r\n        <div className=\"w-full\">\r\n          <input\r\n            type=\"text\"\r\n            required\r\n            placeholder=\"Enter your message...\"\r\n            value={newMessage}\r\n            onChange={(e) => setNewMessage(e.target.value)}\r\n            className={`${styles.input}`}\r\n          />\r\n          <input type=\"submit\" value=\"Send\" className=\"hidden\" id=\"send\" />\r\n          <label htmlFor=\"send\">\r\n            <AiOutlineSend\r\n              size={20}\r\n              className=\"absolute right-4 top-5 cursor-pointer\"\r\n            />\r\n          </label>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserInbox;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}